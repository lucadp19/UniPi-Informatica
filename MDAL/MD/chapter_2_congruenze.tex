\chapter{Congruenze}

\section{Relazione di congruenza}

\begin{definition} \label{def_congr}
    Siano $a, b, m \in \Z$, $m > 0$. Allora si dice che $a$ e' congruo a $b$ modulo $m$ se e solo se $a - b$ e' un multiplo di $m$, e si scrive
    \begin{align*}
        &a \equiv b \pmod m
    \end{align*}
\end{definition}

\begin{theorem}
    Siano $a, b, m \in \Z$, $m > 0$. Allora la relazione di congruenza $\equiv \pmod(m)$ e' una relazione di equivalenza, e dunque soddisfa le proprieta':
    \begin{align}
        &\text{Riflessiva: } &&a \equiv a \Mod{m} \label{congr_rifl}\\
        &\text{Simmetrica: } &&a \equiv b \Mod{m} \implies b \equiv a \Mod{m} \label{congr_simm}\\
        &\text{Riflessiva: } &&a \equiv b \Mod{m} \land b \equiv c \Mod{m} \implies a \equiv c \Mod{m}  \label{congr_trans}
    \end{align}
\end{theorem}
\begin{proof} Dimostriamo le tre proprieta' della congruenza come relazione di equivalenza.
    \begin{enumerate}
        \item $a - a = 0 = 0m$, dunque $a \equiv a \Mod{m}$.
        \item Se $a - b = km$ allora $b - a = -(a - b) = -km = (-k)m$, cioe' $b \equiv a \Mod{m}$.
        \item Se $a - b = km$ e $b - c = hm$ allora $a - c = (a - b) + (b - c) = km + hm = (k + h)m$, 
            cioe' $a \equiv c \Mod{m}$.
    \end{enumerate}
\end{proof}

\begin{theorem} \label{equiv_congr_resto}
    Siano $a, b, m \in \Z$, $m > 0$. Allora
    \begin{equation}
        a \equiv b \Mod{m} \iff a \bmod m = b \bmod m
    \end{equation}
    cioe' $a$ e' congruo a $b$ se e solo se $a$ e $b$ hanno lo stesso resto quando divisi per $m$.
\end{theorem}
\begin{proof}
    Dimostriamo l'implicazione nei due versi.

    Siano $r = a \bmod m$, $r' = b \bmod m$ i resti di $a$ e $b$ modulo $m$, 
    cioe' $a = cq + r$ e $b = cq' + r'$ per qualche $q, q' \in \Z$. Supponiamo 
    che $r = a \bmod m = b \bmod m = b$. Allora
    \begin{alignat*}
        {1}
        a - b &= cq + r - cq' - r' \\
              &= c(q - q')
    \end{alignat*}
    cioe' $a \equiv b \Mod{m}$.

    Ora supponiamo che $a \equiv b \Mod{m}$ e dimostriamo che i resti di $a$ e $b$ modulo $m$ siano uguali.
    Per la proposizione \ref{esistenza_resto} esistono $q, r \in \Z$ tale che $b = mq + r$ e $0 \leq r < m$.
    Allora per definizione di congruenza per qualche $k \in \Z$ avremo
    \begin{alignat*}
        {1}
        a &= b + mk \\
          &= mq + r + mk \\
          &= m(q + k) + r
    \end{alignat*}
    cioe' $r$ e' il resto di $a$ modulo $m$.
\end{proof}

\begin{proposition}
    Siano $a, b, a', b', m \in \Z$, $m > 0$. Allora valgono le seguenti
    \begin{align}
        &a \equiv b \Mod{m}\land a' \equiv b' \Mod{m}\implies a+a' \equiv b+b'\Mod{m} \label{somma_congrui}\\
        &a \equiv b \Mod{m}\land a' \equiv b' \Mod{m}\implies a-a' \equiv b-b'\Mod{m} \label{differenza_congrui}\\
        &a \equiv b \Mod{m}\land a' \equiv b' \Mod{m}\implies aa' \equiv bb'\Mod{m} \label{prodotto_congrui}
    \end{align}
\end{proposition}
\begin{proof}
    \begin{enumerate}
        \item Per definizione di congruenza $m \divides a - b$ e $m \divides a' - b'$. Per la proposizione \ref{divides_sum_subtr_mult} segue che $m \divides (a - b) + (a' - b')$, cioe' $m \divides (a + a') - (b + b')$, che e' equivalente a $a+a' \equiv b+b'\Mod{m}$.
        \item Per definizione di congruenza $m \divides a - b$ e $m \divides a' - b'$. Per la proposizione \ref{divides_sum_subtr_mult} segue che $m \divides (a - b) - (a' - b')$, cioe' $m \divides (a - a') - (b - b')$, che e' equivalente a $a-a' \equiv b-b'\Mod{m}$.
        \item Per definizione di congruenza, scriviamo $a - b = km$ e $a' - b' = hm$, che e' equivalente a $b = a - km$ e $b' = a' - hm$. Dunque
        \begin{alignat*}
            {1}
            bb' &= (a - km)(a' - hm) \\
                &= aa' - ahm - a'km + khm \\
                &= aa' - (ah + a'k - kh)m \\
        \end{alignat*}    
        che e' equivalente a
        \begin{alignat*} {1}
            aa' - bb' &= (ah + a'k - kh)m \\
            \iff aa' &\equiv bb' \Mod{m}.
        \end{alignat*}
        
    \end{enumerate}
    
\end{proof}

\section{Equazioni con congruenze lineari}

\begin{proposition}
    Siano $a, b, c \in \Z$; sia $ax + by = c$ un'equazione diofantea. Allora tutte le soluzioni della diofantea sono soluzioni delle equazioni $ax \equiv c \Mod{b}$ e $by \equiv c \Mod{a}$.
\end{proposition}
\begin{proof}
    Dimostriamo entrambi i versi dell'implicazione.
    \begin{enumerate}
        \item Siano $x, y \in \Z$ tali che $ax + by = c$. Dato che $ax + by$ e' uguale a $c$ segue che $ax + by \equiv c \Mod{b}$. Ma $b \equiv 0 \Mod{b}$, dunque $x$ sara' anche soluzione di $ax \equiv c \Mod{b}$. Analogo ragionamento considerando $ax + by \equiv c \Mod{a}$.
        \item Sia $x \in Z$ tale che $ax \equiv c \Mod{b}$. Allora per definizione di congruenza esiste $k \in \Z$ per cui $ax - c = bk$. Sia $y = -k$; l'equazione e' quindi equivalente a $ax + by = c$, cioe' la coppia $(x, y)$ e' una soluzione dell'equazione diofantea. Analogo ragionamento se partiamo da $by \equiv c \Mod{a}$.
    \end{enumerate}
\end{proof}

Tramite questa proposizione possiamo risolvere ogni equazione contenente congruenze risolvendo l'equazione diofantea associata, o viceversa.

\begin{definition}
    Siano $a \in \Z$; allora si dice che $a$ e' invertibile modulo $m$ se esiste  $x \in \Z$ tale che \[
        ax \equiv 1 \Mod{m}
    .\]
    In particolare tra tutti gli $x$ che soddisfano la relazione precedente, il numero $x$ tale che $0 \leq x < m$ si dice inverso di $a$ modulo $m$.
\end{definition}
Per calcolare gli inversi modulo $m$ basta fare una tabella $m \times m$ in cui le righe e le colonne contengono i numeri tra $0$ e $m-1$, e nella casella $ij$ c'e' il prodotto tra i numeri $i$ e $j$ modulo $m$.

Notiamo che non sempre i numeri diversi da $0$ ammettono inverso modulo $m$.

\begin{theorem}\label{invertibilita_mod_m}
    Siano $a, m \in \Z$. Allora $a$ e' invertibile modulo $m$ se e solo se $\mcd{a}{m} = 1$. 
\end{theorem}
\begin{proof}
    Supponiamo $\mcd{a}{m} = 1$. Allora per il teorema di Bezout \ref{bezout} $\exists x, y \in \Z$ tali che
    \begin{alignat*}{1}
        &ax + my = 1 \\
        \iff &ax - 1 = m(-y) \\
        \iff &ax \equiv 1 \Mod{m}
    \end{alignat*}
    dunque $x$ e' l'inverso di $a$ modulo $m$.

    Supponiamo che $a$ sia invertibile modulo $m$, cioe' che $\exists x \in \Z$ tale che $ax \equiv= 1 \Mod{m}$. Ma sappiamo che $ax + my$ e' un multiplo di $\mcd{a}{m}$, quindi anche $1$ dovra' essere un multiplo di $\mcd{a}{m}$, cioe' $\mcd{a}{m} = 1$, che e' la tesi.
\end{proof}
\begin{corollary}
    Se $p$ e' primo e $a \not\equiv 0 \Mod{p}$, allora $a$ e' invertibile modulo $p$.
\end{corollary}
\begin{proof}
    Se $p$ e' primo, allora necessariamente $p$ e' coprimo con tutti i numeri che non sono suoi multipli, cioe' con tutti gli $a$ tali che $a \equiv_p 0$. Dunque se $a \equiv_p 0$ allora $\mcd{a}{p} = 1$, cioe' per il teorema precedente $a$ e' invertibile modulo $p$.
\end{proof}

\begin{proposition} \label{se_invertibile_allora_soluzione}
    Siano $a, b, m \in \Z$; allora se $a$ e' invertibile modulo $m$ segue che $\exists x \in \Z$ tale che $ax \equiv b \Mod{m}$.
\end{proposition}
\begin{proof}
    Dato che $a$ e' invertibile modulo $m$ esistera' $x' \in \Z$ tale che $ax' \equiv 1 \Mod{m}$. Moltiplicando entrambi i membri per $b$ otteniamo $ax'b \equiv b \Mod{m}$, dunque la $x \equiv x'b \Mod{b}$ soddisfa $ax \equiv b \Mod{m}$, cioe' la tesi.
\end{proof}

\begin{proposition} \label{cong_ha_soluzione_sse_mcd_div_b}
    Siano $a, b, m, x \in \Z$; allora l'equazione $ax \equiv b \Mod{m}$ ha soluzione se e solo se $\mcd{a}{m} \divides b$.
\end{proposition}
\begin{proof}
    Dimostriamo l'implicazione nei due versi.
    \begin{itemize}
        \item Supponiamo che $ax \equiv b \Mod{m}$ ammetta soluzione. Allora esiste $y \in \Z$ tale che $ax - my = b$. Dato che $a$ e $m$ sono multipli di $\mcd{a}{m}$, allora lo sara' anche la combinazione lineare $ax - my$ che e' uguale a $b$, cioe' $\mcd{a}{m} \divides b$.
        \item Supponiamo che $d = \mcd{a}{m}$ divida $b$. Allora $d\divides a$, $d \divides b$, $d \divides m$. Siano $a' = \frac{a}{d}, b' = \frac{b}{d}, m' = \frac{m}{d}$. Allora 
        \begin{align*}
            &ax \equiv b \Mod{m}\\
            \iff{} &ax - b = mk   &\text{per qualche $k \in \Z$} \\
            \iff{} &a'dx - b'd = m'dk &\text{per qualche $k \in \Z$} \\
            \iff{} &a'x - b' = m'k &\text{per qualche $k \in \Z$} \\
            \iff{} &a'x \equiv b'\Mod{m'}.
        \end{align*}
        Ma per il corollario \ref{mcd_diviso_mcd} $\mcd{a'}{m'} = 1$, dunque $a'$ e' invertibile modulo $m'$, dunque per la proposizione \ref{se_invertibile_allora_soluzione} segue che $a'x \equiv b' \Mod{m'}$ ha soluzione. Tuttavia $a'x \equiv b' \Mod{m'}$ e' equivalente a $ax \equiv b \Mod{m}$, dunque anche $ax \equiv b \Mod{m}$ ha soluzione e in particolare ha le stesse soluzioni di $a'x \equiv b' \Mod{m'}$.
    \end{itemize}
\end{proof}

\begin{proposition}
    Se vogliamo semplificare una congruenza possiamo sfruttare le seguenti regole:
    \begin{alignat}{3}
        A &\equiv B \Mod{m} \quad &\iff      \quad &A + c \equiv B + c \Mod{m} \\
        A &\equiv B \Mod{m} \quad &\implies  \quad &cA \equiv cB \Mod{m} \\
        A &\equiv B \Mod{m} \quad &\iff      \quad &(A \bmod m) \equiv (B \bmod m) \Mod{m} \\
        Ad &\equiv Bd \Mod{m} \quad &\implies\quad &A \equiv B \Mod{m} \qquad \text{se }\mcd{d}{m} = 1\\
        Ad &\equiv Bd \Mod{md} \quad &\iff   \quad &A \equiv B \Mod{m}
    \end{alignat}
\end{proposition}
\begin{proof}
    Dimostriamo le 5 proposizioni.
    \begin{enumerate}
        \item Dato che $c \equiv c \Mod{m}$, si tratta di un caso particolare della \ref{somma_congrui}. Inoltre l'implicazione inversa si ricava dalla \ref{differenza_congrui}, dunque si tratta di un'equivalenza.
        \item Dato che $c \equiv c \Mod{m}$, si tratta di un caso particolare della \ref{prodotto_congrui}.
        \item Dato che $A \equiv (A \bmod m) \Mod{m}$ e $B \equiv (B \bmod m) \Mod{m}$, per transitivita' otteniamo che $A \equiv B \Mod{m}$ e' equivalente a $(A \bmod m) \equiv (B \bmod m) \Mod{m}$.
        \item Se $\mcd{d}{m} = 1$ allora esiste l'inverso di $d$ modulo $m$. Chiamiamo $x$ questo inverso e moltiplichiamo entrambi i membri della congruenza per $x$, ottenendo
        \begin{alignat*}
            {1}
            Ad &\equiv Bd \Mod{m}  \\
            \iff Adx &\equiv Bdx \Mod{m} \\
            \iff A \cdot 1 &\equiv B \cdot 1 \Mod{m} \\
            \iff A &\equiv B \Mod{m}.
        \end{alignat*}
        \item Per definizione di congruenza esiste $y \in \Z$ tale che
        \begin{alignat*}
            {1}
            Ad &= Bd + mdy \\
            \iff A &= B + my \\
            \iff A &\equiv B \Mod{m}.
        \end{alignat*}
    \end{enumerate}
\end{proof}

\begin{proposition}
    Siano $a, b, m \in \Z$ noti, $x \in \Z$ non noto. Allora per risolvere l'equazione $ax \equiv b \Mod{m}$ possiamo ricondurci ad uno dei seguenti tre casi:
    \begin{enumerate}
        \item se $\mcd{a}{m} = 1$, allora l'equazione ha soluzione $x \equiv by \Mod{m}$, dove $y$ e' l'inverso di $a$ modulo $m$;
        \item se $\mcd{a}{m} \neq 1$, $d = \mcd{a}{m} \divides b$, allora l'equazione e' equivalente all'equazione $a'x \equiv b' \Mod{m'}$, con $a' = \frac{a}{d}$, $b' = \frac{b}{d}$, $m' = \frac{m}{d}$, che ha soluzione;
        \item se $\mcd{a}{m} \neq 1$, $\mcd{a}{m} \nmid b$, allora l'equazione non ha soluzione.
    \end{enumerate}
\end{proposition}
\begin{proof}
    I tre casi sono conseguenza diretta della proposizione \ref{cong_ha_soluzione_sse_mcd_div_b}. Infatti
    \begin{enumerate}
        \item Per la \ref{cong_ha_soluzione_sse_mcd_div_b} l'equazione ha soluzione. Se $y$ e' l'inverso di $a$, moltiplicando entrambi i membri per $y$ otteniamo la soluzione $x \equiv by \Mod{m}$.
        \item Per la \ref{cong_ha_soluzione_sse_mcd_div_b} l'equazione ha soluzione. 
        Sia $d = \mcd{a}{m}$. Allora la congruenza e' equivalente a $ax - b = mk$ per qualche $k \in \Z$. Dato che $a, b, m$ sono divisibili per $d$, dividendo per $d$ otteniamo l'equazione equivalente
        \begin{alignat*}
            {1}
            &\frac{a}{d}x - \frac{b}{d} = \frac{m}{d}k \\
            \iff &\frac{a}{d}x \equiv \frac{b}{d} \Mod{\frac{m}{d}}
        \end{alignat*}
        Ma per il corollario \ref{mcd_diviso_mcd} $\mcd{\frac{a}{d}}{\frac{m}{d}} = 1$, dunque possiamo trovare la soluzione sfruttando il primo caso.
        \item Per la \ref{cong_ha_soluzione_sse_mcd_div_b} l'equazione non ha soluzione. 
        % Scriviamo l'equazione nella forma equivalente $ax - mk = b$ per qualche $k \in \Z$. Dato che $\mcd{a}{m}$ divide sia $ax$ che $mk$, allora dovra' dividere anche $b$, ma per ipotesi $\mcd{a}{m} \nmid b$, dunque l'equazione non puo' avere soluzione.
    \end{enumerate}
\end{proof}

\section{Sistemi di congruenze}

\begin{theorem}
    [Teorema Cinese del Resto] \label{th_cinese}
    Dato un sistema di congruenze in forma normale 
    \begin{equation*}
        \left\{
        \begin{alignedat}{1}
            x&\equiv a_1 \Mod{m_1}\\
            x&\equiv a_2 \Mod{m_2}\\
            &\vdotswithin{\equiv} \\
            x&\equiv a_n \Mod{m_n}
        \end{alignedat}      
        \right . 
    \end{equation*}
    se i moduli $m_1, m_2, \dots, m_n$ sono a due a due coprimi (cioe' se per ogni $i \neq j$ vale che $\mcd{m_i}{m_j} = 1$) allora il sistema ha soluzione, ed e' equivalente ad una singola congruenza del tipo
    \begin{equation}
        x \equiv x_0 \pmod{m_1 m_2 \dots m_n}.
    \end{equation} 
\end{theorem}

\begin{proposition}
    Dato un sistema di congruenze 
    \begin{equation*}
        \left\{
        \begin{alignedat}{1}
            a_1x &\equiv b_1 \Mod{m_1}\\
            a_2x &\equiv b_2 \Mod{m_2}\\
            &\vdotswithin{\equiv} \\
            a_nx &\equiv b_n \Mod{m_n}
        \end{alignedat}      
        \right . 
    \end{equation*}
    se $x_0$ e' una soluzione particolare, allora tutte le soluzioni del sistema si ottengono sommando a $x_0$ un multiplo di $\operatorname{mcm}(m_1, m_2, \dots, m_n)$; o equivalentemente la soluzione del sistema e' una singola congruenza della forma
    \begin{equation}
        x \equiv x_0 \pmod{\operatorname{mcm}(m_1, m_2, \dots, m_n)}
    \end{equation}
\end{proposition}

\section{Struttura algebrica degli interi modulo m}

\subsection{Interi modulo m}

\begin{definition}
    Siano $a, n \in \Z$; allora si dice classe di resto $[a]_n$ l'insieme 
    \begin{equation}
        [a]_n = \left\{x \in \Z \mid x \equiv a \Mod{n}\right\}.
    \end{equation}
    Il numero $a$ si dice rappresentante della classe $[a]_n$.
\end{definition}

Due classi di resto si dicono uguali se contengono gli stessi elementi.
Il rappresentante di una classe non e' unico, anzi per ogni classe ci sono infinite scelte che corrispondono a tutti i numeri appartenenti alla classe. Vale quindi la seguente osservazione:
\begin{remark}
    $a \equiv b \Mod{m} \iff [a]_n = [b]_n$.
\end{remark}

Notiamo che per ogni numero $n$ ci sono esattamente $n$ classi di resto modulo $n$: infatti ce n'e' una esattamente per ogni possibile resto della divisione per $n$, cioe' per ogni numero tra $0$ e $n-1$ inclusi.

\begin{definition}
    Si dice insieme degli interi modulo $n$ l'insieme
    \begin{equation}
        \Z/(n) = \left\{ [0]_n, [1]_n, \dots, [n-1]_n\right\}.
    \end{equation}
\end{definition}

Possiamo definire due operazioni in $\Z/(n)$ che sono le operazioni di somma ($+ : \Z/(n) \times \Z/(n) \to \Z/(n)$) e prodotto ($\cdot : \Z/(n) \times \Z/(n) \to \Z/(n)$) tali che:
\begin{align}
    &[a]_n + [b]_n = [a+b]_n    &\forall [a]_n, [b]_n \in \Z/(n)\\
    &[a]_n \cdot [b]_n = [ab]_n &\forall [a]_n, [b]_n \in \Z/(n)
\end{align}

\begin{remark}
    Le operazioni di somma e prodotto sono ben definite: il loro risultato non cambia a seconda dei rappresentanti scelti per le classi di congruenza.
\end{remark}

\begin{proposition}\label{Z(n)_anello}
    Per ogni $n \geq 2$ l'insieme $\Z/(n)$ con le operazioni di somma e prodotto tra classi e con gli elementi $[0]_n, [1]_n$ che svolgono il ruolo di $0$ e $1$ e' un anello commutativo.
\end{proposition}
\begin{proof}
    E' facile verificare che valgono gli assiomi degli anelli.
\end{proof}

\begin{proposition}
    Per ogni $p \geq 2$, $p$ primo, l'insieme $\Z/(p)$ con le operazioni di somma e prodotto tra classi e con gli elementi $[0]_n, [1]_n$ che svolgono il ruolo di $0$ e $1$ e' un campo.
\end{proposition}
\begin{proof}
    Per la proposizione \ref{Z(n)_anello} sappiamo che $\Z/(p)$ e' un anello commutativo. Per la proposizione \ref{invertibilita_mod_m} un numero e' invertibile modulo $p$ se e solo se e' coprimo con $pm$; ma tutti i numeri che non sono multipli di $p$ sono coprimi con $p$, dunque tutte le classi tranne $[0]_p$ sono invertibili, dunque esiste l'inverso per la moltiplicazione per ogni elemento non nullo, cioe' $\Z/(p)$ e' un campo.
\end{proof}

\subsection{Gruppo degli inversi modulo m}

\begin{definition}
    Sia $n \geq 2$. Allora si indica con $\inverses{\Z/(n)}$ l'insieme delle classi resto invertibili modulo $n$, ovvero \begin{equation}
        \inverses{\Z/(n)} = \left\{[a]_n \mid \exists [a^{-1}]_n \in \Z/(n). \quad [a]_n[a^{-1}]_n = [1]_n\right\}.
    \end{equation} 
\end{definition}

\begin{proposition}\label{prodotto_invertibili_invertibile}
    Sia $n \geq 2$. Allora se $[a], [b] \in \inverses{\Z/(n)}$ segue che $[ab] \in \inverses{\Z/(n)}$.
\end{proposition}
\begin{proof}
    Ci basta dimostrare che $[ab]$ e' invertibile modulo $n$. Sia $[x]$ l'inverso, se esiste, allora:
    \begin{alignat*}{1}
        &[ab][x] = [1] \\
        \iff &[a][b][x] = [1] \\
        \iff &[a][b][x][a^{-1}][b^{-1}] = [a^{-1}][b^{-1}] \\
        \iff &[x] = [a^{-1}][b^{-1}] = [a^{-1}b^{-1}].
    \end{alignat*}
    ovvero $[ab]$ e' invertibile e $[a^{-1}b^{-1}]$ e' il suo inverso.
\end{proof}

\begin{proposition}\label{Z(n)*_anello}
    Per ogni $n \geq 2$ l'insieme $\inverses{\Z/(n)}$ con l'operazione di prodotto tra classi e con l'elemento $[1]_n$ che svolge il ruolo di $1$ e' un gruppo commutativo.
\end{proposition}

\begin{definition}
    Sia $n \geq 2$. Allora si dice funzione di Eulero la funzione $\varphi : \N \to \N$ tale che \begin{equation}
        \varphi(n) = \abs{\inverses{\Z/(n)}}
    \end{equation}
    ovvero $\varphi(n)$ e' il numero di elementi invertibili in $\Z/(n)$.
\end{definition}

\begin{proposition}
    Sia $p \in \Z$, $p$ primo. Allora $\varphi(p) = p - 1$. 
\end{proposition}
\begin{proof}
    Tutti le classi resto in $\Z/(p)$ tranne $[0]$ sono coprime con $p$, dunque ci sono $p-1$ classi invertibili.
\end{proof}

\begin{proposition}
    Siano $n, p \in \Z$, $p$ primo. Allora $\varphi(p^n) = p^n - p^{n-1}$. 
\end{proposition}
\begin{proof}
    Il numero di elementi in $\Z/(p^n)$ e' $p^n$. 
    
    Da essi dobbiamo escludere tutti i numeri che non sono coprimi con $p^n$, che sono tutti i numeri che contengono $p$ nella loro fattorizzazione in primi, cioe' tutti i multipli di $p$.
    In $[0, p^n - 1]$ ci sono esattamente $\frac{p^n}{p} = p^{n-1}$ multipli di $p$.

    Dunque $\varphi(p^n) = p^n - p^{n-1}$.
\end{proof}

\begin{proposition}
    Siano $a, b \in \Z$, $\mcd{a}{b} = 1$. Allora \begin{equation}
        \varphi(ab) = \varphi(a)\varphi(b).
    \end{equation}
\end{proposition}
\begin{proof}
    Per definizione di $\varphi$ la tesi e' equivalente a \[
        \abs{\inverses{\Z/(ab)}} = \abs{\inverses{\Z/(a)}}\abs{\inverses{\Z/(b)}}.
    \]
    Dalla proposizione \ref{cardinalita_prodotto_cartesiano} del capitolo sulla combinatoria sappiamo che il prodotto tra le cardinalita' e' la cardinalita' del prodotto cartesiano, dunque la tesi e' equivalente a \[
        \abs{\inverses{\Z/(ab)}} = \abs{\inverses{\Z/(a)}\times\inverses{\Z/(b)}}.
    \]

    E' sufficiente dunque dimostrare che esiste una corrisponenza biunivoca tra i due insiemi. Scelgo la funzione $f$ tale che \[
        f([c]_{ab}) = \ang{[c]_a, [c]_b}    
    \] e dimostro che $f$ e' bigettiva.

    \begin{description}
        \item[Iniettivita'.] Siano $[h]_{ab}, [k]_{ab} \in \Z/(ab)$ tali che $f([h]_{ab}) = f([k]_{ab})$, cioe' equivalentemente $\ang{[h]_a, [h]_b} = \ang{[k]_a, [k]_b}$. Dimostriamo che segue che $[h]_{ab} = [k]_{ab}$.
        
        Per definizione di $f$ segue che $x = k$ e' soluzione di \[
            \left\{
            \begin{alignedat}{1}
                &x \equiv h \Mod{a}\\
                &x \equiv h \Mod{b}
            \end{alignedat}
            \right.   
        \] Inoltre banalmente $x = h$ e' soluzione dello stesso sistema, dunque per il Teorema Cinese del Resto (\ref{th_cinese}) (dato che $\mcd{a}{b} = 1$) segue che tutte le soluzioni del sistema sono congrue tra loro modulo $ab$, ovvero $h \equiv k \Mod{ab}$, ovvero $[k]_{ab} = [h]_{ab}$, ovvero $f$ e' iniettiva.
        \item[Surgettivita'.] Sia $\ang{[r]_a, [s]_b} \in \inverses{\Z/(a)}\times\inverses{\Z/(b)}$. Dimostriamo che esiste un unico $[x]_{ab} \in \inverses{\Z/(ab)}$ tale che $f([x]_{ab}) = \ang{[r]_a, [s]_b}$.
        
        Per il teorema cinese dei resti, esiste ed e' unico $[x]_{ab} \in \Z/(ab)$ tale che \[
            \left\{
            \begin{alignedat}{1}
                &x \equiv r \Mod{a}\\
                &x \equiv s \Mod{b}
            \end{alignedat}
            \right.   
        \] 
        
        Dimostriamo ora che $[x]_{ab}$ e' invertibile.
                
        Dato che $[r]_a$ e $[s]_b$ sono invertibili segue che $x$ dovra' essere invertibile modulo $a$ e modulo $b$, dunque $\mcd{x}{a} = \mcd{x}{b} = 1$. Per la proposizione \ref{mcd_togliere_fattori_non_comuni}, dato che $\mcd{x}{a} = 1$ allora $\mcd{x}{ab} = \mcd{x}{b} = 1$, dunque $x$ e' invertibile modulo $ab$, cioe' $[x]_{ab} \in \inverses{\Z/(ab)}$, ovvero $f$ e' surgettiva.
    \end{description}

    Dunque $f$ e' bigettiva e quindi segue la tesi.
\end{proof}

\section{Binomiale e Triangolo di Tartaglia}

\begin{definition}
    Si dice \textbf{coefficiente binomiale} $\binom{n}{k}$ il numero intero tale che \begin{equation}
        \binom{n}{k} = \frac{n!}{k!(n-k)!}
    \end{equation}    
\end{definition}

\begin{proposition}\label{simmetria_binomiale}
    Sia $n \in \Z$, $k \in \Z$ tale che $0 \leq k \leq n$. Allora \begin{equation}
        \binom{n}{k} = \binom{n}{n-k}
    \end{equation}
\end{proposition}
\begin{proof}
    \[\binom{n}{n - k} = \frac{n!}{(n-k)!(n-(n-k))!} = \frac{n!}{k!(n-k)!} = \binom{n}{k} \qedhere\]
\end{proof}

\begin{proposition} \label{binomiale_ricorsivo}
    Sia $n \in \Z$, $k \in \Z$ tale che $0 \leq k \leq n$. Allora \begin{equation}
        \binom{n}{k} = \begin{cases}
            1 &\text{se } k = 0 \text{ oppure } k = n \\
            \binom{n - 1}{k - 1} + \binom{n - 1}{k} &\text{altrimenti}.
        \end{cases}
    \end{equation}
\end{proposition}
\begin{proof}
    Se $k = 0$ allora \[\binom{n}{0} = \frac{n!}{0!(n-0)!} = \frac{n!}{n!} = 1.\] 
    Inoltre per la proposizione \ref{simmetria_binomiale} segue che \[\binom{n}{n} = \binom{n}{n - n} = \binom{n}{0} = 1.\]

    Se $0 < k < n$ allora \begin{alignat*}
        {1}
        \binom{n - 1}{k - 1} + \binom{n - 1}{k} &= \frac{(n-1)!}{(k-1)!(n-1-(k-1))!} + \frac{(n-1)!}{(k)!(n-1-k)!} \\[1em]
        &= \frac{(n-1)!}{(k-1)!(n-1-k)!(n-k)} + \frac{(n-1)!}{k(k-1)!(n-1-k)!} \\[1em]
        &= \frac{(n-1)!k + (n-k)(n-1)!}{k(k-1)!(n-1-k)!(n-k)} \\[1em]
        &= \frac{(n-1)!k + n(n-1)! - k(n-1)!}{k!(n-k)!} \\
        &= \frac{n!}{k!(n-k)!} \\[1em]
        &= \binom{n}{k}
    \end{alignat*}
    che e' la tesi.
\end{proof}

\begin{theorem}[del binomiale] \label{binomiale}
    Siano $x, y, n \in \Z$. Allora vale che
    \begin{equation}
        (x+y)^n = \binom{n}{0}x^0y^n + \binom{n}{1}x^1y^{n-1} + \dots + \binom{n}{n}x^ny^0 = \sum_{k=0}^n \binom{n}{k}x^{n-k}y^k
    \end{equation}
\end{theorem}

\begin{definition}
    Si dice triangolo di Tartaglia un triangolo che ha le seguenti proprieta':
    \begin{enumerate}
        \item le righe sono numerate a partire da $0$;
        \item ogni riga ha $n + 1$ elementi, che vengono numerati da $0$ a $n$;
        \item l'elemento in riga $n$ e posizione $k$ si indica con $T_{n, k}$;
        \item $T_{n, 0} = T_{n, n} = 1$;
        \item per ogni $n \geq 0$, $0 < k \leq n$, $T_{n + 1, k} = T_{n, k - 1} + T_{n, k}$.
    \end{enumerate}
\end{definition}


\begin{proposition}
    Sia $n \in \Z$. Allora per ogni $k \in \Z$ tale che $0 \leq k \leq n$ segue che \begin{equation}
        T_{n,k} = \binom{n}{k}
    \end{equation}
\end{proposition}
\begin{proof}
    Per induzione su $n$.
    \begin{itemize}
        \item[\textbf{Caso base.}]

        Sia $n = 0$, allora dato che $0 \leq k \leq n$ segue che $k = 0$. Dunque
        \[
            T_{0, 0} = 1 = \binom{0}{0}.    
        \]
        \item[\textbf{Passo induttivo.}]
        
        Supponiamo che la tesi sia vera per $n$ e dimostriamola per $n+1$. 
        \begin{itemize}
            \item Se $k = 0$ oppure $k = n + 1$ allora per definizione del triangolo di Tartaglia $T_{n+1, 0} = T_{n+1, n+1} = 1$ che e' esattamente $\binom{n+1}{0} = \binom{n+1}{n+1}$ (per la proposizione \ref{binomiale_ricorsivo}),
            \item Se $0 < k < n+1$ allora per definizione del triangolo di Tartaglia segue che \[
                T_{n+1, k} = T_{n, k-1} + T_{n, k} = \binom{n}{k-1} + \binom{n}{k} = \binom{n+1}{k}    
            \] dove l'ultimo passaggio viene dalla proposizione \ref{binomiale_ricorsivo}.
        \end{itemize}
    \end{itemize}
    Dunque la tesi e' vera per ogni $n \in \Z$.
\end{proof}

\begin{proposition}
    Il triangolo di Tartaglia gode delle seguenti proprieta':
    \begin{enumerate}
        \item la somma degli elementi della riga $n$ e' $2^n$;
        \item la somma a segni alterni degli elementi di ogni riga e' $0$;
        \item nella riga $n$, l'elemento al posto $k$ e l'elemento al posto $n-k$ hanno lo stesso valore.
    \end{enumerate}
\end{proposition}
\begin{proof}
    Dimostriamo le tre proposizioni.
    \begin{enumerate}
        \item Dimostriamo che $2^n = \sum_{k=0}^n T_{n, k} = \sum_{k=0}^n \binom{n}{k}$.
        \[2^n = (1+1)^n = \sum_k^0 \binom{n}{k}1^{n-k}1^k = \sum_{k=0}^n \binom{n}{k}\]
        \item La somma a segni alterni della riga $n$-esima e' \[\sum_{k=0}^n (-1)^kT_{n, k} = \sum_{k=0}^n (-1)^k\binom{n}{k} = \sum_{k=0}^n (-1)^k1^{n-k}\binom{n}{k} = (1-1)^k = 0^k = 0.\]
        \item Dobbiamo dimostrare che $T_{n, k} = T_{n, n-k}$. Ma dato che $T_{n, k} = \binom{n}{k}$ e $T_{n, n-k} = \binom{n}{n-k}$, allora questo e' equivalente a dimostrare che $\binom{n}{k} = \binom{n}{n-k}$, che e' vero per la proposizione \ref{simmetria_binomiale}. \qedhere
    \end{enumerate}
\end{proof}

\begin{proposition}\label{binomio_pk_divisibile_p}
    Se $p$ e' primo, allora per ogni $k$ tale che $0 < k < p$ vale che
    \begin{equation}
        \binom{p}{k} \equiv 0 \Mod{p}
    \end{equation}
\end{proposition}
\begin{proof}
    Consideriamo un $k$ generico tale che $0 < k < p$.
    Allora \[
        \binom{p}{k} = \frac{p!}{k!(p-k)!} \iff p! = \binom{p}{k}(p-k)!k!    
    \]
    Ma $p \divides p!$, dunque $p \divides \binom{p}{k}(p-k)!k!$, dunque per la proposizione \ref{primo_divide_prodotto} segue che \[
        p \divides \binom{p}{k} \text{ oppure } p \divides (p-k)! \text{ oppure } p \divides k!
    .\]

    Notiamo che sia $k$ che $p-k$ sono numeri minori di $p$, dunque $k!$ e $(p-k)!$ sono un prodotto di numeri minori di $p$. Ma $p$ e' primo, dunque e' coprimo con tutti i numeri che non siano un multiplo di $p$ (e quindi e' coprimo con tutti i numeri compresi tra $0$ e $p$ esclusi), dunque per la proposizione \ref{prodotto_coprimo_n} $p$ deve essere coprimo anche con $k!$ e con $(p-k)!$. 
    
    Da cio' segue che $p$ non puo' dividere $k!$ e $(p-k)!$.
    L'ultima possibilita' e' che $p \divides \binom{p}{k}$, che e' equivalente a dire che $\binom{p}{k} \equiv 0 \Mod{p}$.
\end{proof}

\begin{proposition}\label{(x+y)^p_congr_x^p+y^p}
    Siano $x, y, p \in \Z$, $p$ primo. Allora
    \begin{equation}
        (x+y)^p \equiv x^p + y^p \Mod{p}
    \end{equation}
\end{proposition}
\begin{proof}
    Per il teorema del Binomiale (\ref{binomiale}) sappiamo che
    \begin{alignat*}{1}
        (x+y)^p &= \binom{p}{0}x^p + \binom{p}{1}x^{p-1}y^1 + \dots + \binom{p}{i}x^{p-i}y^i + \dots + \binom{p}{p}y^p \\
        \intertext{Ma per la proposizione \ref{binomio_pk_divisibile_p} tutti i termini intermedi di questa somma sono congrui a $0$ modulo $p$, dunque:}
        &\equiv \binom{p}{0}x^p + \binom{p}{p}y^p \Mod{p}\\
        &\equiv x^p + y^p \Mod{p}
    \end{alignat*}
    come volevasi dimostrare.
\end{proof}

\begin{corollary}\label{(x_1+x_n)^p_congr_x_1^p+x_n^p}
    Siano $x_1, x_2, \dots, x_n, p \in \Z$, $p$ primo. Allora
    \begin{equation}
        (x_1+x_2+\dots+x_n)^p \equiv x_1^p + x_2^p + \dots + x_n^p \Mod{p}
    \end{equation}
\end{corollary}
\begin{proof}
    Per induzione su n.
    \begin{itemize}
        \item[\textbf{Caso base.}]

        Sia $n = 1$. Allora $x_1^p \equiv x_1^p \Mod{p}$ ovviamente.
        \item[\textbf{Passo induttivo.}]
        
        Supponiamo che la tesi sia vera per $n-1$ e dimostriamola per $n$.
        \begin{alignat*}{1}
            (x_1+x_2+\dots+x_n)^p &\equiv ((x_1+x_2+\dots+x_{n-1})+x_n)^p \Mod{p}\\
            \intertext{(per la proposizione \ref{(x+y)^p_congr_x^p+y^p})}
            &\equiv (x_1+x_2+\dots+x_{n-1})^p+x_n^p\Mod{p}\\
            \intertext{(per ipotesi induttiva)}
            &\equiv x_1^p + x_2^p + \dots + x_{n-1}^p + x_n^p\Mod{p}
        \end{alignat*}
        che e' la tesi per $n$.
    \end{itemize}
    Dunque dal caso base e dal passo induttivo segue che la tesi vale per ogni $n$.
\end{proof}

\begin{theorem}
    [Piccolo Teorema di Fermat] \label{th_fermat}
    Se $p$ e' primo, allora $x^p \equiv x \Mod{p}$.
\end{theorem}
\begin{proof}
    \begin{alignat*}{1}
        x^p &\equiv (\overbrace{1 +\dots+ 1}^{x \text{ volte}})^p \Mod{p}\\
        \intertext{(per il corollario \ref{(x_1+x_n)^p_congr_x_1^p+x_n^p})}
        &\equiv \overbrace{1^p +\dots+ 1^p}^{x \text{ volte}} \Mod{p}\\
        &\equiv \overbrace{1 +\dots+ 1}^{x \text{ volte}} \Mod{p}\\
        &\equiv x \Mod{p}
    \end{alignat*}
    che e' la tesi.
\end{proof}

\begin{corollary} \label{corollario_fermat}
    Se $p$ e' primo e $x \nequiv 0 \Mod{p}$ allora $x^{p-1} \equiv 1 \Mod{p}$.
\end{corollary}
\begin{proof}
    Per il piccolo teorema di Fermat (\ref{th_fermat}) vale che $x^p \equiv x \Mod{p}$. Dato che $x \nequiv 0 \Mod{p}$ allora segue che $p$ e $x$ sono coprimi, dunque $x$ e' invertibile modulo $p$. Moltiplicando entrambi i membri per l'inverso $x^{-1}$ otteniamo \begin{alignat*}
        {1}
        &x^px^{-1} \equiv x\cdot x^{-1} \Mod{p}\\
        \iff &x^{p-1} \equiv 1 \Mod{p}
    \end{alignat*}
    che e' la tesi.    
\end{proof}

\section{Congruenze esponenziali}

Iniziamo con un esempio di congruenza esponenziale.
\begin{example}
    Trovare tutte le soluzioni di $3^x \equiv 5 \Mod{7}$.
\end{example}
\begin{solution}
    Proviamo per tentativi:
    \begin{alignat*}
        {2}
        &x = 0 \implies &&3^0 \equiv 1 \nequiv 5 \Mod{7}\\
        &x = 1 \implies &&3^1 \equiv 3 \nequiv 5 \Mod{7}\\
        &x = 2 \implies &&3^2 \equiv 9 \equiv 2 \nequiv 5 \Mod{7}\\
        &x = 3 \implies &&3^3 \equiv 3^2 \cdot 3 \equiv 2 \cdot 3 \equiv 6 \nequiv 5 \Mod{7}\\
        &x = 4 \implies &&3^4 \equiv 3^2 \cdot 3^2 \equiv 2 \cdot 2 \equiv 4 \nequiv 5 \Mod{7}\\
        &x = 5 \implies &&3^5 \equiv 3^2 \cdot 3^3 \equiv 2 \cdot 6 \equiv 12 \equiv 5 \Mod{7}\\
        &x = 6 \implies &&3^6 \equiv 3^3 \cdot 3^3 \equiv 6 \cdot 6 \equiv 36 \equiv 1 \nequiv 5 \Mod{7}
    \end{alignat*}
    Dunque $x = 5$ e' una soluzione. Non possiamo dire pero' che le soluzioni sono tutti i numeri della forma $x = 5 + 7k$, perche' possiamo notiare che i numeri sembrano ripetersi con periodo $6$ e non $7$ (infatti $3^0 \equiv 3^6 \equiv 1 \Mod{7}$). 

    Dimostriamo che se $x = 5$ e' soluzione, allora anche $x = 5 +6k$ lo e'. Infatti \[
        3^{5 + 6k} \equiv 3^5 \cdot 3^{6k} \equiv 3^5 \cdot 1^k \equiv 5 \Mod{7}.
    \]
    Dunque le soluzioni sono tutte le $x$ tali che $x \equiv 5 \Mod{6}$. Questo vale anche per $x$ negativi, ma dobbiamo definire $x^{-1}$ non come $\frac{1}{x}$ ma come l'inverso di $x$ modulo $m$.
\end{solution}

\begin{definition}
    Siano $a, m \in \Z$, $a \nmid m$. Allora si dice ordine di $a$ modulo $m$ il piu' piccolo intero positivo $\ord{a}{m}$ tale che \begin{equation}
        a^{\ord{a}{m}} \equiv 1 \Mod{m}.
    \end{equation}
\end{definition}

\begin{remark}
    Notiamo che $\ord{a}{m}$ deve essere positivo, e dunque in particolare maggiore di $0$. Inoltre la condizione $a \nmid m$, che equivale a $a \nequiv 0 \Mod{m}$ serve ad evitare la congruenza banale $0^x \equiv b \Mod{m}$, che ha soluzione se e solo se $b \equiv 0 \Mod{m}$.
\end{remark}

\begin{proposition}\label{multipli_ord_equiv_1}
    Siano $a, m \in \Z$, $a \nmid m$. Allora per ogni $k \in \Z$ vale che \begin{equation}
        a^{k\ord{a}{m}} \equiv 1 \Mod{m}.
    \end{equation}
\end{proposition}
\begin{proof}
    \[
        a^{k\ord{a}{m}} \equiv (a^{\ord{a}{m}})^k \equiv 1^k \equiv 1 \Mod{m}. \qedhere
    \]
\end{proof}

\begin{proposition}\label{solo_multipli_ord_equiv_1}
    Siano $a, m \in \Z$, $a \nmid m$. Allora \begin{equation}
        a^x \equiv 1 \Mod{m} \iff x \equiv 0 \Mod{\ord{a}{m}}
    \end{equation}
\end{proposition}
\begin{proof}
    Per definizione di congruenza 
    \[x \equiv 0 \Mod{\ord{a}{m}} \iff x \mid \ord{a}{m} \iff x = \ord{a}{m}\cdot k\] 
    per qualche $k \in \Z$.

    Per l'unicita' del resto della divisione euclidea (\ref{esistenza_resto}) possiamo scrivere che $x = q\ord{a}{m} + r$ per qualche $q, r \in \Z$ con $0 \leq r < \ord{a}{m}$. Questo e' equivalente a dire \begin{alignat*}
        {1}
        &\begin{alignedat}
            {1}
            a^x &= a^{q\ord{a}{m} + r}\\
            &= a^{q\ord{a}{m}}\cdot a^r
        \end{alignedat} \\
        \intertext{che equivale a}
        &\begin{alignedat}
            {1}
            a^x &\equiv a^{q\ord{a}{m}}\cdot a^r \Mod{m} \\
            &\equiv 1 \cdot a^r \Mod{m}\\
            &\equiv a^r \Mod{m}
        \end{alignedat}
    \end{alignat*}
    dove abbiamo sfruttato la proposizione \ref{multipli_ord_equiv_1} per dire che $a^{q\ord{a}{m}}\equiv 1 \Mod{m}$.

    Dunque dato che $a^x \equiv a^r \Mod{m}$ segue che $a^x \equiv 1 \Mod{m}$ se e solo se $a^r \equiv 1 \Mod{m}$. Ma $r < \ord{a}{m}$, dunque se $r$ fosse maggiore di $0$ avremmo trovato un numero minore di $\ord{a}{m}$ per cui $a^r \equiv 1 \Mod{m}$, che e' assurdo poiche' va contro la minimalita' di $\ord{a}{m}$.

    Segue che $r = 0$, cioe' $x = q\ord{a}{m}$, cioe' equivalentemente $x \equiv 0 \Mod{\ord{a}{m}}$, come volevasi dimostrare.
\end{proof}

\begin{proposition}
    Siano $a, b, m \in \Z$, $a \nmid m$. Se $x_0 \in \Z$ e' una soluzione di $a^x \equiv b \Mod{m}$ allora le soluzioni sono tutte e solo della forma \begin{equation}
        x \equiv x_0 \Mod{\ord{a}{m}}.
    \end{equation}
\end{proposition}
\begin{proof}
    Dimostriamo che se $x = x_0 + k\ord{a}{m}$ allora $x$ e' soluzione.
    \begin{alignat*}
        {1}
        a^{x_0 + k\ord{a}{m}} &\equiv a^{x_0}a^{k\ord{a}{m}} \Mod{m} \\
        &\equiv b \cdot 1 \Mod{m} \\
        &\equiv b \Mod{m}.
    \end{alignat*}
    Dimostriamo ora che se $x$ e' soluzione, allora $x \equiv x_0 \Mod{\ord{a}{m}}$, cioe' equivalentemente $x - x_0 = k\ord{a}{m}$.
    \begin{alignat*}
        {1}
        a^{x - x_0} &\equiv a^{x}a^{-x_0} \Mod{m} \\
        &\equiv b \cdot b^{-1} \Mod{m} \\
        &\equiv 1 \Mod{m}.
    \end{alignat*}
    Ma per la proposizione \ref{solo_multipli_ord_equiv_1} $a^{x - x_0} \equiv 1 \Mod{m}$ se e solo se $x - x_0 \equiv 0 \Mod{\ord{a}{m}}$, cioe' se e solo se $x \equiv x_0 \Mod{\ord{a}{m}}$, che e' la tesi.
\end{proof}

\begin{proposition}
    Siano $a, p \in \Z$, $a \nmid p$, $p$ primo. Allora vale che $\ord{a}{p} \divides p-1$.
\end{proposition}
\begin{proof}
    Per il corollario al piccolo teorema di Fermat (\ref{corollario_fermat}) sappiamo che $a^{p-1} \equiv 1 \Mod{p}$, cioe' $p-1$ e' una soluzione dell'equazione $a^x \equiv 1 \Mod{p}$. 
    
    Per la proposizione \ref{solo_multipli_ord_equiv_1} segue che $p-1 \equiv 0 \Mod{\ord{a}{p}}$, cioe' $\ord{a}{p} \mid p-1$, che e' la tesi.
\end{proof}

Dunque se dobbiamo trovare l'ordine di un numero $a$ modulo un primo $p$ ci basta provare tutti i divisori di $p - 1$ fino a quando non troviamo il minimo divisore che soddisfa la proprieta'.
