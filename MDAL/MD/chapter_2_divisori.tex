\chapter{Divisori e MCD}

\section{Divisori di un numero}

\subsection{Definizioni e prime conseguenze}

\begin{definition}[Divisore]
    Siano $a, b \in \Z$; allora si dice che $a$ divide $b$ se
    $\exists k \in \Z$ tale che $ak = b$, e si scrive $a \divides b$.
\end{definition}

\begin{definition}[Multiplo]
    Siano $a, b \in \Z$. Allora si dice che $b$ è multiplo di $a$ se $\exists k \in \Z$ tale che $b = ak$.
\end{definition}
\begin{remark}
    La definizione di multiplo è speculare a quella di divisore: se $a$ è divisore di $b$ allora $b$ è multiplo di $a$.
\end{remark}

\begin{proposition} \label{divides_sum_subtr_mult}
    Siano $a, b, n \in \Z$ tali che $n \divides a$ e $n \divides b$. Allora
    \begin{alignat}{2}
        &n \divides a + b \label{divides_sum}\\
        &n \divides a - b \label{divides_subtr} \\
        &n \divides ax \qquad&\forall x \in \Z \label{divides_mult}
    \end{alignat} 
\end{proposition}
\begin{proof}  
    Per ipotesi, dato che $n \divides a$ e $n \divides b$, allora $\exists h, k \in \Z$ tali che
    $nh = a$ e $nk = b$. Dunque:
    \begin{alignat*}{2}
        a + b = nh + nk = n(h + k) &\iff n \divides a + b \\
        a - b = nh - nk = n(h - k) &\iff n \divides a - b \\
        ax = nhx = n(hx) &\iff n \divides ax
    \end{alignat*}
    che è la tesi.
\end{proof}

\begin{definition}[Massimo comun divisore]
    Siano $a, b \in \Z$; allora si dice $\mcd{a}{b}$ il piu' grande intero positivo
    tale che $\mcd{a}{b} \divides a$ e $\mcd{a}{b} \divides b$.
\end{definition}

\begin{definition}[Minimo comune multiplo]
    Siano $a, b \in \Z$. Allora si dice minimo comune multiplo di $a$ e $b$ il numero $d = \mcm{a}{b}$ tale che $d$ è il piu' piccolo multiplo positivo sia di $a$ che di $b$.
\end{definition}

\begin{definition}[Coprimo]
    Siano $a, b \in \Z$. Se $\mcd{a}{b} = 1$ allora $a$ e $b$ si dicono coprimi.
\end{definition}

\begin{remark}
    Siano $a, b \in \Z$. Allora valgono le seguenti proprietà per $\mcd{a}{b}$:
    \begin{align*}
        \mcd{a}{b} &= \mcd{\pm a}{\pm b} \\
        \mcd{a}{1} &= \mcd{1}{a} = 1 \\
        \mcd{a}{0} &= \mcd{0}{a} = 0 \\
        \nexists \mcd{0}{0}
    \end{align*}
\end{remark}

\begin{theorem}[Esistenza e unicità del resto] \label{esistenza_resto}
    Siano $a, b \in \Z$, con $b \neq 0$. Allora esistono e sono unici $q, r \in \Z$ tali che
    \begin{align}
        a = bq + r, \qquad0 \leq r < \abs{b}
    \end{align}
    Tale $r$ si dice resto della divisione di $a$ per $b$, e si indica anche con $r = a\bmod b$.
\end{theorem}

\begin{proof}
    Notiamo che i numeri della forma $a - bq$ formano una progressione aritmetica di passo $b$ al variare di $q \in \Z$. 
    Il resto $r$ definito in questo modo è l'unico elemento di questa progressione compreso tra $0$ e $b - 1$.
\end{proof}

\begin{proposition}\label{mcm|c_iff_a,b|c}
    Siano $a, b, c \in \Z$. Allora \begin{equation}
        \mcm{a}{b} \divides c \iff a \divides c \land b \divides c
    \end{equation}
\end{proposition}
\begin{proof}
    Dimostriamo separatamente i due versi dell'implicazione.
    \begin{itemize}
        \item[($\implies$)] Dato che $\mcm{a}{b}$ è un multiplo di $a$ e di $b$ e per ipotesi $c$ è un multiplo di $\mcm{a}{b}$, allora per transitività segue che $c$ è un multiplo di $a$ e di $b$.
        \item[($\impliedby$)] Supponiamo che $c$ sia un multiplo di $a$ e di $b$. Allora per il teorema \ref{esistenza_resto} esistono $q, r \in \Z$ tali che \[
        c = \mcm{a}{b}q + r
    \]
    con $0 \leq r < \mcm{a}{b}$.
    Dato che $a$, $b$ dividono sia $c$ (per ipotesi) che $\mcm{a}{b}$ (per definizione di mcm), allora segue che essi dividono anche $r$. Ma $0 \leq r < \mcm{a}{b}$, dunque necessariamente $r = 0$, cioè $c = \mcm{a}{b}q$ e quindi $\mcm{a}{b} \divides c$. \qedhere
    \end{itemize}
\end{proof}


\subsection{Algoritmo di Euclide e Teorema di Bezout}

\begin{theorem} \label{mcd_a_a-b}
    Siano $a, b \in \Z$. Allora
    \begin{equation}
        \mcd{a}{b} = \mcd{a}{b - a} = \mcd{a - b}{b}.
    \end{equation} 
\end{theorem}
\begin{proof}  
    Ovviamente $\mcd{a}{b} = \mcd{b}{a}$, dunque se vale la prima uguaglianza varrà anche la seconda,
    in quanto 
    \[
       \mcd{a}{b} = \mcd{b}{a} = \mcd{b}{a - b} = \mcd{a - b}{b}.
    \] 
    Dunque è sufficiente
    dimostrare che $\mcd{a}{b} = \mcd{a}{b - a}$.
    Sia $\mathbb{D}_{x, y}$ l'insieme dei divisori comuni a $x$ e $y$, cioe'
    \[
        \mathbb{D}_{x, y} = \left\{d \tc d \divides x \land d \divides y \right\}  
    \]
    Allora per dimostrare la tesi è sufficiente dimostrare che $\mathbb{D}_{a, b} = \mathbb{D}_{a, b - a}$, in quanto
    se i due insiemi sono uguali necessariamente anche i loro massimi saranno uguali.

    Dimostriamo che $\mathbb{D}_{a, b} \subseteq \mathbb{D}_{a, b - a}$. Sia $d \in \mathbb{D}_{a, b}$, 
    cioè $d \divides a$ e $d \divides b$. Allora per la proposizione \ref{divides_sum_subtr_mult} segue che
    $d \divides b - a$, cioè $d \in \mathbb{D}_{a, b - a}$, 
    cioè $\mathbb{D}_{a, b} \subseteq \mathbb{D}_{a, b - a}$.

    Dimostriamo ora che $\mathbb{D}_{a, b - a} \subseteq \mathbb{D}_{a, b}$. 
    Sia $d \in \mathbb{D}_{a, b - a}$, 
    cioè $d \divides a$ e $d \divides b - a$. Allora per la proposizione \ref{divides_sum_subtr_mult} segue che
    $d \divides a + (b - a)$, cioè $d \divides b$, cioè $d \in \mathbb{D}_{a, b}$, 
    cioè $\mathbb{D}_{a, b - a} \subseteq \mathbb{D}_{a, b}$.

    Dunque dato che valgono sia $\mathbb{D}_{a, b} \subseteq \mathbb{D}_{a, b - a}$ e 
    $\mathbb{D}_{a, b - a} \subseteq \mathbb{D}_{a, b}$, allora vale
     $\mathbb{D}_{a, b} = \mathbb{D}_{a, b - a}$. In particolare il massimo di questi due insiemi
     dovrà essere lo stesso, quindi $\mcd{a}{b} = \mcd{a}{b - a}$, che è la tesi.
\end{proof}

Dunque per calcolare il massimo comun divisore si puo' sfruttare il seguente algoritmo, detto \textbf{algoritmo di Euclide}, che si basa sul teorema \ref{mcd_a_a-b}:
\begin{enumerate}
    \item Se $a = 1$ oppure $b = 1$ allora $\mcd{a}{b} = 1$.
    \item Se $a = 0$ e $b \neq 0$ allora $\mcd{a}{b} = b$.
    \item Se $a \neq 0$ e $b = 0$ allora $\mcd{a}{b} = a$.
    \item Se $a \neq 0$ e $b \neq 0$, allora
        \begin{itemize}
            \item se $a \leq b$ segue che $\mcd{a}{b} = \mcd{a - b}{b}$;
            \item se $a > b$ segue che $\mcd{a}{b} = \mcd{a}{b - a}$
        \end{itemize}
        dove i valori di $\mcd{a - b}{b}$ o $\mcd{a}{b - a}$ vengono calcolati riapplicando l'algoritmo.
\end{enumerate}
Possiamo velocizzare il procedimento usando i resti della divisione invece che la sottrazione:
\begin{enumerate}[4.]
    \item Se $a \neq 0$ e $b \neq 0$, allora
    \begin{itemize}
        \item se $a \leq b$ segue che $\mcd{a}{b} = \mcd{a \bmod b}{b}$;
        \item se $a > b$ segue che $\mcd{a}{b} = \mcd{a}{b \bmod a}$
    \end{itemize}
    dove i valori di $\mcd{a \bmod b}{b}$ o $\mcd{a}{b \bmod a}$ vengono calcolati riapplicando l'algoritmo.
\end{enumerate}

\begin{theorem}
    [Teorema di Bezout] \label{bezout}
    Siano $a, b \in \Z$. Allora esistono $x, y \in \Z$ tali che
    \begin{equation}
        ax + by = \mcd{a}{b}.
    \end{equation}
\end{theorem}
\begin{proof}
    Siano $r_0 = a$, $r_1 = b$. Definisco la successione $(r_n)$ come la sequenza dei resti della divisione dati dall'algoritmo di Euclide per l'mcd:\begin{align*}
        \mcd{a}{b} &= \mcd{r_0}{r_1} &&\text{sia } r_2 = r_0 \bmod{r_1}: \\
        &= \mcd{r_1}{r_2} &&\text{sia } r_3 = r_1 \bmod{r_2}: \\
        &= \dots\\
        &= \mcd{r_n}{r_{n+1}} &&\text{sia } r_{n+2} = r_n \bmod{r_{n+1}}:\\
        &= \dots
    \end{align*}
    Questo processo ha termine quando un resto $r_{m+1}$ è uguale a $0$: in quel caso $\mcd{r_m}{r_{m+1}} = \mcd{r_m}{0}= r_m = \mcd{a}{b}$.

    Dimostriamo che per ogni $n$ possiamo scrivere $r_n$ come $ax_n + by_n$ per qualche $x_n, y_n \in \Z$.
    \begin{description}
        \item[Caso base] Per $r_0$ e $r_1$ è banale: \begin{align*}
            r_0 = 1\cdot a + 0 \cdot b, &&r_1 = 0 \cdot a + 1 \cdot b.
        \end{align*}
        \item[Passo induttivo] Supponiamo di saper scrivere $r_n$ e $r_{n-1}$ come combinazione di $a$ e $b$ e dimostriamo che possiamo farlo anche per $r_{n+2}$.
       
        Per ipotesi induttiva esistono $x_n, y_n, x_{n+1}, y_{n+1} \in \Z$ tali che \begin{align*}
            r_n = ax_n + by_n, && r_{n+1} = ax_{n+1} + by_{n+1}.
        \end{align*}

        Per definizione $r_{n+2} = r_n \bmod{r_{n+1}}$, ovvero per definizione di resto $r_{n+2} = r_n - q_{n+1}r_{n+1}$ per qualche $q_{n+1} \in \Z$. Sostituendo otteniamo \begin{align*}
            r_{n+2} &= r_n - q_{n+1}r_{n+1}\\
            &= ax_n + by_n - q_{n+1}(ax_{n+1} + by_{n+1})\\
            &= a(x_n - q_{n+1}x_{n+1}) + b(y_n - q_{n+1}y_{n+1}).
        \end{align*}
        Dunque $x_{n+2} = x_n - q_{n+1}x_{n+1}$ e $y_{n+2} = y_n - q_{n+1}y_{n+1}$, cioè possiamo esprimere $r_{n+2}$ come combinazione lineare di $a, b$.
    \end{description}

    Dato che per induzione questo risultato vale per tutti gli $n \in \N$, varrà anche per $m$, ovvero esistono $x, y \in \Z$ tali che $r_m = ax + by$. Ma $r_m = \mcd{a}{b}$, dunque la tesi.
\end{proof}

\subsection{Conseguenze del teorema di Bezout}

Elenchiamo in questa sezione alcune conseguenze del teorema di Bezout sulle proprietà dei divisori e sul loro rapporto con il massimo comun divisore di due numeri.

\begin{proposition} \label{n_divides_product}
    Siano $a, b, n \in \Z$. Allora \begin{equation}
        n \divides ab \land \mcd{a}{n} = 1 \implies n \divides b.
    \end{equation}
\end{proposition}
\begin{intuition}
    Se $n$ divide $ab$, allora tutti i fattori primi che dividono $n$ dovranno essere contenuti in $ab$. Dato che $\mcd{n}{a} = 1$, questi fattori non possono essere contenuti in $a$, dunque dovranno essere tutti contenuti in $b$.
\end{intuition}
\begin{proof}
    Per il teorema di Bezout (\ref{bezout}) esistono $x, y \in \Z$ tali che 
    \begin{align*}
        ax + ny &= \mcd{a}{n} = 1 \\
        \intertext{Moltiplicando per $b$ otteniamo}
        abx + nby &= b 
    \end{align*}
    Ma $n \divides abx$ (poiche $n \divides ab$) e $n \divides nby$, dunque $n \divides abx + nby$, 
    cioè $n \divides b$.
\end{proof}

\begin{proposition} \label{greatest_common_divisor}
    Siano $a, b, t \in \Z$ tali che $t \divides a$, $t \divides b$. Allora $t \leq \mcd{a}{b}$.
\end{proposition}
\begin{proof}
    La proposizione deriva direttamente dalla definizione di massimo comun divisore: se $t$ è un divisore comune ad $a$ e $b$, allora $t$ sarà minore o uguale al massimo dei divisori comuni di $a$ e $b$, cioè $t \leq \mcd{a}{b}$.
\end{proof}

\begin{proposition} \label{divisori_dividono_mcd}
    Siano $a, b, t \in \Z$ tali che $t \divides a$, $t \divides b$.  Allora $t \divides \mcd{a}{b}$.
\end{proposition}
\begin{proof}
    Per la proposizione \ref{divides_sum_subtr_mult}, se $t \divides a$ e $t \divides b$ allora $t \divides ax+by$ per ogni $x, y \in \Z$.

    Per il teorema di Bezout (\ref{bezout}) esistono $\bar{x}, \bar{y} \in \Z$ tali che $a\bar{x}+b\bar{y} = \mcd{a}{b}$. Ma quest'espressione è della forma $ax + by$, con $x = \bar{x}$, $y = \bar{y}$, dunque 
    $t \divides a\bar{x} + b\bar{y}$, cioè $t \divides \mcd{a}{b}$.
\end{proof}

\begin{proposition} \label{t_divides_gcd_lincomb}
    Siano $a, b, t \in \Z$. Allora 
    \begin{equation}
        t \divides \mcd{a}{b} \iff (\forall x, y \in \Z. \quad t \divides ax + by).
    \end{equation}
\end{proposition}
\begin{proof}
    Dimostriamo entrambi i versi dell'implicazione.
    \begin{itemize}
        \item[($\implies$)] Se $t \divides \mcd{a}{b}$, allora $t \divides a$ e $t \divides b$, dunque per la proposizione \ref{divides_sum_subtr_mult} segue che $t$ dovrà dividere una qualsiasi combinazione lineare di $a$ e $b$, cioè $t \divides ax+by$ per ogni $x, y \in \Z$.
        \item[($\impliedby$)] Viceversa supponiamo che $t \divides ax+by$ per ogni $x, y \in \Z$. Siano per il teorema di Bezout (\ref{bezout}) $\bar{x}, \bar{y}$ i numeri tali che $a\bar{x} + b\bar{y} = \mcd{a}{b}$. Allora $t$ dovrà dividere anche $a\bar{x} + b\bar{y}$, cioè $t \divides \mcd{a}{b}$. \qedhere
    \end{itemize}
\end{proof}

\begin{proposition} \label{mcd_of_multiples_of_n}
    Siano $a, b, n \in \Z$. Allora \begin{equation}
        \mcd{an}{bn} = n\mcd{a}{b}.
    \end{equation}
\end{proposition}
\begin{intuition}
    Se due numeri hanno $n$ come fattore comune, ovviamente il massimo comun divisore dovrà contenere $n$ e quindi dovrà essere un multiplo di $n$.
\end{intuition}
\begin{proof}
    Osserviamo che se due numeri hanno gli stessi divisori allora sono uguali, a meno del segno.
    Sia $t \in \Z$ tale che $t \divides an$ e $t \divides nb$. Per la proposizione \ref{t_divides_gcd_lincomb} allora 
    \begin{alignat*}
        {2}
        &t \divides \mcd{an}{bn}\\
        \iff &t \divides nax + nby      \qquad& \forall x, y \in \Z \\
        \iff &t \divides n(ax + by)     \qquad& \forall x, y \in \Z \\
        \intertext{dunque scegliendo $x, y$ tali che $ax+by = \mcd{a}{b}$ per Bezout (\ref{bezout})}
        \iff &t \divides n\mcd{a}{b}. \tag*{\qedhere}
    \end{alignat*}
\end{proof}


\begin{corollary} \label{mcd_diviso_mcd}
    Siano $a, b \in \Z$ e sia $d = \mcd{a}{b}$. Allora $\mcd{\frac{a}{d}}{\frac{b}{d}} = 1$.
\end{corollary}
\begin{intuition}
    Se dividiamo due numeri per il loro mcd stiamo eliminando dalla loro fattorizzazione tutti i primi comuni ad entrambi, quindi i due numeri risultanti dall'operazione non potranno avere primi in comune e quindi saranno coprimi.
\end{intuition}
\begin{proof}
    Siano $a^\prime, b^\prime$ tali che $a = a^\prime d, b = b^\prime d$. Allora per la proposizione \ref{mcd_of_multiples_of_n}
    \begin{alignat*}{1}
        \mcd{a}{b} &= \mcd{a^\prime d}{b^\prime d} \\
                   &= d\mcd{a^\prime}{b^\prime} \\
                   &= \mcd{a}{b} \mcd{a^\prime}{b^\prime}.
        \end{alignat*} 
    Dividendo entrambi i membri per $\mcd{a}{b}$ otteniamo \[
        \mcd{a^\prime}{b^\prime} = 1 
    \]
    che, per definizione di $a^\prime, b^\prime$, è equivalente a \[
        \mcd{\frac{a}{d}}{\frac{b}{d}} = 1
    \]
    che è la tesi.
\end{proof}

\section{Numeri primi}

\begin{definition}[Numero primo]
    Sia $p \in \Z$. Si dice che $p$ è primo se se gli unici interi che dividono $p$ sono
    $\pm 1$ e $\pm p$.
\end{definition}

\begin{proposition}\label{primo_divide_prodotto}
    Se $p$ è primo e $p \divides ab$, allora $p \divides a$ oppure $p \divides b$.
\end{proposition}
\begin{proof}
    Supponiamo $p \nmid a$. Dato che $p$ è primo, $\mcd{a}{p} = 1$ oppure $p$.
    Tuttavia se $\mcd{a}{p} = p$ allora $p \divides a$, che va contro l'ipotesi, dunque 
    $\mcd{a}{p} = 1$. Per la proposizione \ref{n_divides_product} allora $p \divides b$, che è la tesi.
\end{proof}

\begin{proposition} \label{prodotto_numeri_coprimi}
    Siano $a, b \in \Z, c \in \Z$ tali che $\mcd{a}{b} = 1$. Allora
    \begin{equation}
        a \divides c \land b \divides c \iff ab \divides c.
    \end{equation}
\end{proposition}
\begin{proof}
    Per il teorema di Bezout (\ref{bezout}) esistono $x, y \in \Z$ tali che $\mcd{a}{b} = 1 = ax+by$, da cui segue $n = nax + nby$.

    Dato che $a \divides n$, $b \divides n$, allora $ab \divides na$ e $ab \divides nb$ per la proposizione \ref{divides_sum_subtr_mult}, quindi per la stessa proposizione $ab$ dividerà una loro qualunque combinazione lineare $nak + nbh$, inclusa quella con $k = x, h = y$.

    Dunque $ab \divides nax + nby$ che è equivalente a dire che $ab \divides n$, cioè la tesi.
\end{proof}


\begin{proposition} \label{prodotto_coprimo_2}
    Siano $a, b, c \in \Z$. Allora
    \begin{equation}
        \mcd{ab}{c} = 1 \iff \mcd{a}{c} = \mcd{b}{c} = 1.
    \end{equation}
\end{proposition}
\begin{intuition}
    Dimostrazione intuitiva: se $a$ e $b$ sono coprimi con $c$ significa che $a$ non ha nessun fattore in comune con $c$, e stessa cosa per $b$. Ma il loro prodotto $ab$ viene diviso dagli stessi primi che dividono $a$ e $b$ separatamente, quindi deve essere anch'esso coprimo con $c$.

    Al contrario, se $ab$ non ha fattori primi in comune con $c$, allora naturalmente $a, b$ (essendo divisori di $ab$) non avranno fattori in comune con $c$.
\end{intuition}

\begin{corollary} \label{prodotto_coprimo_n}
    Siano $a_1, a_2, \dots, a_n \in \Z, c \in \Z$ tali che $a_1, \dots, a_n$ siano coprimi con $c$. Allora anche il loro prodotto $\prod_{i = 1}^{n} a_i$ è coprimo con $c$.
\end{corollary}
\begin{intuition}
    Stessa idea della dimostrazione della proposizione \ref{prodotto_coprimo_2} ma estesa a $n$ numeri.
\end{intuition}

\begin{proposition}
    Siano $a_1, a_2, \dots, a_n \in \Z, c \in \Z$ tali che $a_1, \dots, a_n$ siano coprimi tra loro e che per ogni $i<n$ vale che $a_i \divides c$.
    Allora \begin{equation}
        a_1a_2\dots a_n = \left( \prod_{i = 1}^n a_i \right) \divides c.
    \end{equation}
\end{proposition}
\begin{intuition}
    Quest'ultima proposizione ci dice che se $a_1, \dots, a_n$ non hanno fattori primi in comune e ognuno di loro divide $c$, allora anche il loro prodotto dovrà dividere $c$, perché il loro prodotto è formato esattamente dai fattori primi che dividono $c$.
\end{intuition}
\begin{proof}
    Dimostriamo la proposizione per induzione su $n$.
    \begin{description}
        \item[Caso base.] 
        Sia $n = 0$, cioè $a_1\dots a_n = 1$. Allora banalmente $1 \divides c$.
        \item[Passo induttivo.]         
        Supponiamo che la tesi sia vera per $n-1$ e dimostriamola per $n$. Dunque per ipotesi $ \left(\prod_{i = 1}^{n - 1} a_i\right) \divides c$.
        Ma per il corollario \ref{prodotto_coprimo_n} $a_n$ è coprimo con $\prod_{i = 1}^{n - 1} a_i$, dunque per la proposizione \ref{prodotto_numeri_coprimi} segue che
        \begin{equation*}
            a_n \left(\prod_{i = 1}^{n - 1} a_i\right) = \left( \prod_{i = 1}^{n} a_i \right) \divides c
        \end{equation*}
        che è la tesi per $n$.
    \end{description}
    Dunque la proposizione vale per ogni $n \in N$.
\end{proof}


\subsection{Divisori primi}
\begin{proposition} 
    [Esistenza della scomposizione in primi]
    \label{esistenza_scomposizione_primi}
    Sia $n \in \Z, n > 1$. Allora $n$ puo' essere espresso come prodotto di potenze di numeri primi.
\end{proposition}
\begin{proof}
    Per induzione forte su $n$.
    \begin{description}
        \item[Caso base.]
        Sia $n = 2$. Dato che $2$ è primo, allora è esprimibile come prodotto di numeri primi (in particolare è il prodotto di un solo termine, se stesso).
        \item[Passo induttivo.]
        Supponiamo che la tesi sia vera per $2, 3, \dots, n-1$ (induzione forte) e dimostriamola per $n$.
        Abbiamo due casi:
        \begin{itemize}
            \item se $n$ è primo, allora è un prodotto di primi e quindi la tesi vale;
            \item se $n$ non è primo allora dovranno esistere due numeri $1 < a, b < n$ tali che $n = ab$ (infatti se non esistessero $n$ sarebbe primo). Ma per l'ipotesi induttiva forte sappiamo che tutti i numeri compresi tra $2$ e $n-1$ inclusi sono scomponibili in fattori primi, dunque anche $n = ab$ dovrà esserlo.
        \end{itemize}
    \end{description}
    Dunque dal caso base e dal passo induttivo segue che la tesi vale per ogni $n \geq 2$.
\end{proof}

\begin{theorem}
    [Teorema fondamentale dell'aritmetica]
    Sia $n \in \Z$ e siano $p_1, p_2, \dots, p_k$ i primi che dividono $n$. Inoltre siano $e_1, e_2, \dots, e_k$ i massimi esponenti per cui vale che $p_i^{e_i} \divides n$ per ogni $1 \leq i \leq k$. Allora $n = p_1^{e_1}p_2^{e_2} \dots p_k^{e_k}$.
\end{theorem}
\begin{proof}
    Per la proposizione \ref{esistenza_scomposizione_primi} sappiamo che esistono $p_1, \dots, p_n$. Per la proposizione \ref{prodotto_coprimo_n} segue che \[
        p_1^{e_1}p_2^{e_2} \dots p_k^{e_k} \divides n    
    \]
    in quanto $p_1^{e_1}, p_2^{e_2}, \dots, p_k^{e_k}$ sono coprimi tra loro.

    Dunque $n = m \cdot p_1^{e_1}p_2^{e_2} \dots p_k^{e_k}$ per qualche $m \in \Z$.
    Supponiamo per assurdo che $m \neq 1$. Allora per la proposizione \ref{esistenza_scomposizione_primi} $m$ è scomponibile in numeri primi; ma dato che $m$ è un divisore di $n$ segue che i primi che dividono $m$ devono dividere anche $n$, dunque i primi che dividono $m$ devono essere tra $p_1, \dots, p_k$. 

    Supponiamo senza perdita di generalità che $p_i$ divida $m$. Allora dato che $m \cdot p_1^{e_1}p_2^{e_2} \dots p_k^{e_k} = n$ deve essere $p_i \cdot p_i^{e_i} = p_i^{e_i+1} \divides n$, che è assurdo in quanto abbiamo supposto che $e_i$ fosse il massimo esponente per cui $p_i^{e_i} \divides n$. 
    
    Dunque deve essere $m = 1$, cioè \[
        n = p_1^{e_1}p_2^{e_2} \dots p_k^{e_k}
    \]
    come volevasi dimostrare.
\end{proof}

\begin{proposition}\label{mcd_mcm_in_termini_di_divisori_primi}
    Siano $a, b, k \in \Z$, $p \in \Z$ primo. Allora
    \begin{alignat}{1}
        p^k \divides \mcd{a}{b} &\iff p^k \divides a \land p^k \divides b \\ 
        p^k \divides \mcm{a}{b} &\iff p^k \divides a \lor p^k \divides b.
    \end{alignat}
\end{proposition}
\begin{intuition}
    Il massimo comun divisore di due numeri è un divisore comune ad entrambi, quindi se $p^k$ lo divide deve dividere entrambi i numeri.

    Il minimo comune multiplo invece è formato da tutti i fattori primi comuni e non comuni col massimo esponente, quindi se $p^k$ divide il minimo comune multiplo dovrà dividere almeno uno dei due numeri di partenza.
\end{intuition}

\begin{proposition}\label{mcm_equals_product}
    Siano $a, b \in \Z$. Allora se $\mcd{a}{b} = 1$ segue che $\mcm{a}{b} = \abs{ab}$.
\end{proposition}
\begin{intuition}
    Se i due numeri sono coprimi, allora non hanno fattori primi in comune, dunque il loro minimo comune multiplo sarà formato precisamente da tutti i fattori di entrambi i numeri, cioè dal loro prodotto.
\end{intuition}
\begin{proof}
    Sappiamo per definizione di mcm che $a \divides \mcm{a}{b}$ e $b \divides \mcm{a}{b}$. Dato che $\mcd{a}{b} = 1$ per la proposizione \ref{prodotto_numeri_coprimi} segue che $ab \divides \mcm{a}{b}$, cioè $\abs{ab} \leq \mcm{a}{b}$. Ma $ab$ è un multiplo di $a$ e di $b$, quindi dovrà valere che $\abs{ab} \geq \mcm{a}{b}$ in quanto $\mcm{a}{b}$ è il minimo multiplo comune ad $a$ e $b$. Da cio' segue che $\mcm{a}{b} = \abs{ab}$, cioè la tesi.
\end{proof}

\begin{proposition} \label{mcd_togliere_fattori_non_comuni}
    Siano $a, x, y \in \Z$. Allora 
    \begin{equation}
        \mcd{a}{x} = 1 \implies \mcd{a}{xy} = \mcd{a}{y}.
    \end{equation}
\end{proposition}
\begin{intuition}
    Se stiamo calcolando $\mcd{a}{b}$ dove $b = xy$ e sappiamo che il fattore $x$ non è comune tra $b$ ed $a$, allora possiamo escluderlo dal massimo comun divisore.
\end{intuition}
\begin{proof}
    Dato che $\mcd{a}{x} = 1$, allora se un primo $p$ divide $a$ sicuramente $p$ non divide $x$. Per la proposizione \ref{mcd_mcm_in_termini_di_divisori_primi} allora vale
    \begin{alignat*}
        {1}
        &p^k \divides \mcd{a}{xy} \\ 
        \iff &p^k \divides a \land p^k \divides xy\\
        \intertext{ma $p^k \nmid x$ dunque per la \ref{n_divides_product}}
        \iff &p^k \divides a \land p^k \divides y \\
        \iff &p^k \divides \mcd{a}{y}.
    \end{alignat*}
    Dato che $\mcd{a}{xy}$ e $\mcd{a}{y}$ vengono divisi dagli stessi primi, per il teorema fondamentale devono essere uguali.
\end{proof}

\begin{proposition} \label{distributivita_mcd_su_mcm}
    Siano $a, x, y \in \Z$. Allora 
    \begin{equation}
        \mcd{a}{\mcm{x}{y}} = \mcm{\mcd{a}{x}}{\mcd{a}{y}}.
    \end{equation}
\end{proposition}
\begin{proof}
    Per la proposizione \ref{mcd_mcm_in_termini_di_divisori_primi} allora vale
    \begin{alignat*}
        {1}
        &p^k \divides \mcd{a}{\mcm{x}{y}}\\ 
        \iff &p^k \divides a \land (p^k \divides x \lor p^k \divides y)\\
        \iff &(p^k \divides a \land p^k \divides x) \lor (p^k \divides a \land p^k \divides y) \\
        \iff &p^k \divides \mcm{\mcd{a}{x}}{\mcd{a}{y}}.
    \end{alignat*}
    Dato che $\mcd{a}{\mcm{x}{y}}$ e $\mcm{\mcd{a}{x}}{\mcd{a}{y}}$ vengono divisi dagli stessi primi, per il teorema fondamentale devono essere uguali.
\end{proof}

\begin{proposition}
    Siano $a, x, y \in \Z$. Allora 
    \begin{equation}
        \mcd{x}{y} = 1 \implies \mcd{a}{xy} = \mcd{a}{x}\mcd{a}{y}.
    \end{equation}
\end{proposition}
\begin{intuition}
    Se $x$ e $y$ non hanno fattori in comune, i fattori che $a$ ha in comune con il loro prodotto sono o in $x$ o in $y$, quindi per ottenerli tutti possiamo dividere l'mcd in due e moltiplicare i due risultati.
\end{intuition}
\begin{proof}
    Dato che $\mcd{x}{y} = 1$ allora per la proposizione \ref{mcm_equals_product} vale che $\mcm{x}{y} = \abs{xy}$.
    Dunque $\mcd{a}{xy} = \mcd{a}{\abs{xy}} = \mcd{a}{\mcm{x}{y}} = \mcm{\mcd{a}{x}}{\mcd{a}{y}}$ per la proposizione \ref{distributivita_mcd_su_mcm}.

    Verifichiamo ora che $\mcd{a}{x}$ e $\mcd{a}{y}$ sono coprimi. Per ipotesi sappiamo che $x, y$ sono coprimi; ma dato che $\mcd{a}{x}$ e $\mcd{a}{y}$ sono divisori di $x$ e $y$ rispettivamente, allora dovranno essere anche loro coprimi.

    Dunque per la proposizione \ref{mcm_equals_product} segue che \[
        \mcd{a}{xy} = \mcm{\mcd{a}{x}}{\mcd{a}{y}} = \mcd{a}{x}\mcd{a}{y}
    \] che è la tesi.
\end{proof}

\begin{proposition}\label{a,b|c_iff_(ab/mcd)|c}
    Siano $a, b, c \in \Z$. Allora \begin{equation}
        a \divides c \land b \divides c \iff \frac{ab}{\mcd{a}{b}} \divides c.
    \end{equation}
\end{proposition}
\begin{proof}
    Dimostriamo l'implicazione in entrambi i versi.
    \begin{itemize}
        \item[($\implies$)] Supponiamo che $a \divides c$ e $b \divides c$. Sia $d = \mcd{a}{b}$. Allora dato che $d \divides a$, $d \divides b$ per transitività $d \divides c$, dunque $\frac{a}{d} \divides \frac{c}{d}$ e $\frac{b}{d} \divides \frac{c}{d}$. Ma dato che per il corollario \ref{mcd_diviso_mcd} sappiamo che $\mcd{\frac{a}{d}}{\frac{b}{d}} = 1$, dunque per la \ref{prodotto_numeri_coprimi} segue che il loro prodotto $\frac{ab}{d^2}$ dovrà dividere $\frac{c}{d}$, che è equivalente a dire che $\frac{ab}{d} \divides c$.
        \item[($\impliedby$)] NON SO FARE QUEST'ALTRA DIMOSTRAZIONE \qedhere
    \end{itemize}
\end{proof}

\begin{proposition}
    \label{mcm*mcd=ab}
    Siano $a, b \in \Z$. Allora
    \begin{equation}
        \mcd{a}{b}\mcm{a}{b} = \abs{ab}.
    \end{equation}
\end{proposition}
\begin{proof}
    Sia $c \in \Z$ tale che $a \divides c$, $b \divides c$. Allora per la proposizione \ref{a,b|c_iff_(ab/mcd)|c} segue che $\frac{ab}{\mcd{a}{b}} \divides c$. Inoltre per la proposizione \ref{mcm|c_iff_a,b|c} segue che $\mcm{a}{b} \divides c$.
    Dunque i due numeri $\frac{ab}{\mcd{a}{b}}$ e $\mcm{a}{b}$ hanno gli stessi divisori, dunque devono essere uguali a meno del segno, da cui segue \[
        \mcd{a}{b}\mcm{a}{b} = \abs{ab}. 
    \]
\end{proof}

\section{Equazioni diofantee}

\begin{definition}[Equazione diofantea]
    Siano $a, b, c \in \Z$ noti, $x, y \in \Z$ incognite. Allora un'equazione lineare della forma $ax + by = c$ si dice equazione diofantea.
\end{definition}

\begin{theorem}[Condizione necessaria e sufficiente per le diofantee]
    Siano $a, b, c \in \Z$. Allora l'equazione diofantea $ax + by = c$ ammette soluzioni se e solo se $\mcd{a}{b} \divides c$.
\end{theorem}
\begin{proof}
    Dimostriamo prima che se $\mcd{a}{b} \divides c$ allora esistono soluzioni di $ax + by = c$ e poi dimostriamo che se $\mcd{a}{b} \nmid c$ allora l'equazione $ax + by = c$ non ha soluzioni.
    \begin{itemize}
        \item Supponiamo che $c = k\mcd{a}{b}$ per qualche $k \in \Z$. Allora per il teorema di Bezout \ref{bezout} esistono $x', y^\prime \in \Z$ tali che $ax^\prime + by^\prime = \mcd{a}{b}$. Moltiplicando  entrambi i membri per $k$ otteniamo
        \begin{alignat*}{2} 
            k\mcd{a}{b} &= k(ax^\prime + by')
                        &= akx^\prime + bky'
                        &= a(kx') + b(ky')
        \end{alignat*}
        dunque $x = kx'$ e $y = ky'$ risolvono l'equazione diofantea.
        \item Supponiamo ora che $c$ non sia un multiplo di $\mcd{a}{b}$ e supponiamo per assurdo che l'equazione abbia soluzione, cioè che esistano $x, y \in \Z$ tali che $ax + by = c$. Sia $d = \mcd{a}{b}$.
        
        Per definizione di $\mcd{a}{b}$ e per la proposizione \ref{divides_sum_subtr_mult}, dato che $d \divides a$ e $d \divides b$ segue che $d \divides ax$, $d \divides by$ e dunque $d \divides ax + by$. Ma $ax + by = c$, quindi $d = \mcd{a}{b} \divides c$, che va contro le ipotesi.

        Dunque l'equazione diofantea non ha soluzione, cioè la tesi. \qedhere
    \end{itemize}
\end{proof}

\begin{theorem} [Soluzioni di una diofantea omogenea con coefficienti coprimi]\label{sol_diofantea_omogenea_coprimi}
    Siano $a, b \in \Z$ coprimi. Allora le soluzioni dell'equazione diofantea omogenea $ax + by = 0$ sono tutte e solo della forma $x = -kb, y = ka$ al variare di $k \in \Z$.
\end{theorem}
\begin{proof}
    Dimostriamo innanzitutto che $x = -kb, y = ka$ è una soluzione.
    \begin{alignat*}{1}
        ax + by &= a(-kb) + b(ka)\\
                &= -kab + kab\\
                &= 0.
    \end{alignat*}

    Mostriamo ora che non vi possono essere altre soluzioni. 
    
    Dato che $ax + by = 0$, allora $ax = -by$.
    Dato che $a \divides ax$ allora $a \divides -by$; inoltre per ipotesi $\mcd{a}{-b} = \mcd{a}{b} = 1$.
    Dunque per il teorema \ref{n_divides_product} segue che $a \divides y$, cioè $y = ak$ per qualche $k \in \Z$. Sostituendo ottengo $x = -b\frac{y}{a} = -bk$, che è la tesi.
\end{proof}

\begin{corollary} [Soluzioni di una diofantea omogenea]\label{sol_diofantea_omogenea}
    Se $a, b$ non sono coprimi, allora tutte le soluzioni dell'equazione $ax + by = 0$ saranno della forma $x = -kb^\prime, y = ka^\prime$ dove $a^\prime = \frac{a}{\mcd{a}{b}}$ e $b^\prime = \frac{b^\prime}{\mcd{a}{b}}.$
\end{corollary}
\begin{proof}
    Dato che $a, b$ non sono coprimi, allora possiamo dividere entrambi i membri di $ax + by = 0$ per $\mcd{a}{b}$ ottenendo l'equazione diofantea equivalente $a^\prime x + b^\prime y = 0$. 
    
    Ma per il teorema \ref{mcd_diviso_mcd} $\mcd{a^\prime}{b^\prime} = 1$, dunque per il teorema \ref{sol_diofantea_omogenea_coprimi} le sue soluzioni saranno tutte e solo della forma $x = -kb^\prime, y = ka^\prime$. 
    
    Ma questa equazione è equivalente all'originale, dunque anche le soluzioni di $ax + by = 0$ saranno tutte e solo della forma $x = -kb^\prime, y = ka^\prime$.
\end{proof}

\begin{theorem} [Soluzioni di una diofantea non omogenea] \label{sol_diofantea_non_omog}
    Siano $a, b \in \Z$ e sia $(x, y)$ una soluzione particolare dell'equazione diofantea $ax + by = c$ (se esiste). Allora le soluzioni di quest'equazione sono tutte e solo della forma $(x + x_0, y + y_0)$ al variare di $(x_0, y_0)$ tra le soluzioni dell'equazione omogenea associata $ax + by = 0$.
\end{theorem}
\begin{proof}
    Dimostriamo innanzitutto che se $(x, y)$ è una soluzione della diofantea non omogenea e $(x_0, y_0)$ è una soluzione dell'omogenea, allora $(x+x_0, y+y_0)$ è ancora soluzione della non omogenea.
    \begin{alignat*}{1}
        a(x + x_0) + b(y + y_0) &= ax + ax_0 + by + by_0 \\
                                &= (ax + by) + (ax_0 + by_0) \\
                                &= c + 0\\
                                &= c.
    \end{alignat*}

    Dimostriamo ora che tutte le soluzioni sono di questa forma. Sia $(\bar{x}, \bar{y})$ una soluzione particolare della diofantea non omogenea e $(x, y)$ un'altra soluzione qualsiasi, e mostriamo che la loro differenza è una soluzione dell'omogenea associata.
    \begin{alignat*}
        {1}
        a(x - \bar{x}) + b(y - \bar{y}) &= ax - a\bar{x} + by - b\bar{y} \\
                                        &= (ax + by) - (a\bar{x} + b\bar{y}) \\
                                        &= c - c\\
                                        &= 0
    \end{alignat*}
    che è la tesi.
\end{proof}
